<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Thai Trip 2026 - Hua Hin & Bangkok</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&family=Playfair+Display:ital@1&display=swap" rel="stylesheet">

    <!-- Babel for JSX transformation -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Import Map for React & Icons -->
    <script type="importmap">
    {
        "imports": {
            "react": "https://esm.sh/react@18.2.0",
            "react-dom/client": "https://esm.sh/react-dom@18.2.0/client",
            "lucide-react": "https://esm.sh/lucide-react@0.263.1"
        }
    }
    </script>

    <style>
        body {
            background-color: #C4E0E0;
            font-family: 'Inter', sans-serif;
            -webkit-tap-highlight-color: transparent;
        }
        .font-serif {
            font-family: 'Playfair Display', serif;
        }
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fade-in {
            animation: fadeIn 0.4s ease-out forwards;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel" data-type="module">
        import React, { useState, useEffect } from 'react';
        import { createRoot } from 'react-dom/client';
        import { 
            Plane, MapPin, Calendar, Home, User, ArrowRight, ChevronLeft, 
            ChevronDown, ChevronUp, MoreHorizontal, Clock, Users, Sun, Moon, 
            Info, CheckSquare, Thermometer, Zap, Banknote, Phone, Utensils, 
            Coffee, ShoppingBag, Camera, BedDouble, RefreshCcw, Wifi, 
            AlertCircle, Key, Cloud, CloudRain, Wind, ExternalLink, Map as MapIcon, FileText
        } from 'lucide-react';

        // --- Data Source ---
        const TRIP_DATA = {
            '2/25': {
                title: "Departure Night",
                desc: "Taoyuan Airport -> Bangkok",
                icon: <Plane size={20} />,
                events: [
                    { time: "19:45", title: "桃園機場集合", desc: "TPE 桃園機場集合 (無網上報到，需臨櫃)", icon: "users" },
                    { time: "21:15", title: "搭乘 SL395 起飛", desc: "前往曼谷廊曼機場 (DMK)", icon: "plane" },
                    { time: "00:15", title: "抵達曼谷 DMK", desc: "預計抵達時間 (跨日 2/26)", icon: "map-pin" },
                    { time: "01:15", title: "入住飯店", desc: "SHIN Patara Living Hotel", icon: "moon" }
                ]
            },
            '2/26': {
                title: "Hua Hin Transfer",
                desc: "Bangkok -> Hua Hin Beach",
                icon: <Sun size={20} />,
                events: [
                    { time: "09:00", title: "換錢小分隊出動", desc: "協助大家換華欣兩日花費", icon: "banknote" },
                    { time: "10:00", title: "包車前往華欣", desc: "車程約 3-3.5 小時，中途停 7-11/Amazon", icon: "car" },
                    { time: "13:00", title: "抵達飯店", desc: "The Standard Hua Hin", icon: "home" },
                    { time: "14:00", title: "午餐 Nong JJ", desc: "在地知名餐廳", icon: "utensils", link: "https://maps.app.goo.gl/SjoAAn4g1RwRJu6y5" },
                    { time: "15:30", title: "自由活動", desc: "享受飯店設施或海灘", icon: "coffee" },
                    { time: "19:30", title: "晚餐 Praça", desc: "飯店內餐廳享用泰式料理", icon: "utensils", link: "https://maps.app.goo.gl/YVReUVe6M383Uzgz9" }
                ]
            },
            '2/27': {
                title: "Explore or Chill",
                desc: "Sam Roi Yot / Night Markets",
                icon: <Camera size={20} />,
                events: [
                    { time: "06:30", title: "早餐 / 準備出發", desc: "參加三百峰者先行用餐", icon: "coffee" },
                    { time: "08:00", title: "三百峰國家公園", desc: "私人探索之旅 (參加者出發)", icon: "camera" },
                    { time: "09:00", title: "自由活動", desc: "沒參加行程者可享受飯店/按摩", icon: "sun" },
                    { time: "18:30", title: "集合逛夜市", desc: "Cicada + Tamarind Night Markets", icon: "shopping-bag" },
                    { time: "21:00", title: "按摩/購物", desc: "Let's Relax Spa 或 Blúport 大賣場", icon: "moon" }
                ]
            },
            '2/28': {
                title: "Back to BKK",
                desc: "Hua Hin -> Bangkok City",
                icon: <ShoppingBag size={20} />,
                events: [
                    { time: "09:00", title: "包車回曼谷", desc: "車程約 3-3.5 小時", icon: "car" },
                    { time: "12:00", title: "Check-in BKK", desc: "ASAI Bangkok Chinatown", icon: "home" },
                    { time: "12:30", title: "午餐 Ari 區", desc: "Ari 區享用午餐", icon: "utensils" },
                    { 
                        time: "14:00", 
                        title: "自由逛街路線 (三選一)", 
                        desc: (
                        <ul className="space-y-3 mt-3">
                            <li className="flex gap-2 items-start">
                            <span className="shrink-0 font-bold bg-[#0F1C20] text-[#FF9F68] text-[10px] px-1.5 rounded py-0.5 mt-0.5">A</span>
                            <span><span className="font-bold">恰圖恰 + DD Mall</span> 逛街 ➔ 隨後前往嵩越路逛街</span>
                            </li>
                            <li className="flex gap-2 items-start">
                            <span className="shrink-0 font-bold bg-[#0F1C20] text-[#FF9F68] text-[10px] px-1.5 rounded py-0.5 mt-0.5">B</span>
                            <span>叫車至 <span className="font-bold">泰國設計中心 (TCDC)</span> 或搭 BTS 到 Saphan Taksin 站 ➔ 慢慢逛到嵩越路</span>
                            </li>
                            <li className="flex gap-2 items-start">
                            <span className="shrink-0 font-bold bg-[#0F1C20] text-[#FF9F68] text-[10px] px-1.5 rounded py-0.5 mt-0.5">C</span>
                            <span>直接在 <span className="font-bold">Ari 區</span> 逛街喝咖啡休息 ➔ 隨後前往嵩越路逛街</span>
                            </li>
                        </ul>
                        ), 
                        icon: "map" 
                    },
                    { time: "18:30", title: "晚餐 Lon Lon Local Diner", desc: "集合吃晚餐", icon: "utensils", link: "https://maps.app.goo.gl/oDgChLURo5wJHGYF7" },
                    { time: "20:00", title: "晚間活動", desc: "按摩 / BigC 採買 / 休息", icon: "moon" }
                ]
            },
            '3/1': {
                title: "Bangkok Vibes",
                desc: "Temples, Shopping & Night Out",
                icon: <Camera size={20} />,
                events: [
                    { time: "06:30", title: "飯店早餐", desc: "供應時間至 10:30", icon: "coffee" },
                    { 
                        time: "09:00", 
                        title: "分隊行動 (早上)", 
                        desc: (
                        <ul className="space-y-2 mt-2">
                            <li className="flex gap-2 items-start">
                            <span className="shrink-0 font-bold bg-[#0F1C20] text-[#FF9F68] text-[10px] px-1.5 rounded py-0.5 mt-0.5">A隊</span>
                            <span>09:00 鄭王廟參觀 + 體驗泰服</span>
                            </li>
                            <li className="flex gap-2 items-start">
                            <span className="shrink-0 font-bold bg-[#0F1C20] text-[#FF9F68] text-[10px] px-1.5 rounded py-0.5 mt-0.5">B隊</span>
                            <span>10:00 通羅、澎澎、Ekkamai 逛街</span>
                            </li>
                        </ul>
                        ), 
                        icon: "users" 
                    },
                    { time: "12:00", title: "自由午餐", desc: "各自尋找喜愛的餐廳 (12:00-13:00)", icon: "utensils" },
                    { 
                        time: "15:00", 
                        title: "下午行程 (二選一)", 
                        desc: (
                        <ul className="space-y-2 mt-2">
                            <li className="flex gap-2 items-start">
                            <span className="shrink-0 font-bold bg-[#0F1C20] text-[#FF9F68] text-[10px] px-1.5 rounded py-0.5 mt-0.5">A</span>
                            <span>Siam 商圈 (Siam Square ➔ CentralWorld)</span>
                            </li>
                            <li className="flex gap-2 items-start">
                            <span className="shrink-0 font-bold bg-[#0F1C20] text-[#FF9F68] text-[10px] px-1.5 rounded py-0.5 mt-0.5">B</span>
                            <span>回飯店休息 或 找咖啡廳放鬆</span>
                            </li>
                        </ul>
                        ), 
                        icon: "map" 
                    },
                    { time: "17:30", title: "晚餐 Inter Restaurants", desc: "現場排隊，享用道地泰菜，吃完繼續逛", icon: "utensils", link: "https://maps.app.goo.gl/hn1eX6SR5QDjM2L69" },
                    { time: "20:00", title: "晚間活動", desc: "按摩 / 酒吧路跑 (Bar Us + Dry Wave + Spire) / BigC", icon: "moon" }
                ]
            },
            '3/2': {
                title: "Home Sweet Home",
                desc: "Last Shopping & Departure",
                icon: <Plane size={20} />,
                events: [
                    { time: "06:30", title: "飯店早餐", desc: "供應時間至 10:30", icon: "coffee" },
                    { 
                        time: "10:00", 
                        title: "第一梯次 (JX742)", 
                        desc: (
                        <div className="space-y-1 mt-1 text-sm border-l-2 border-[#FF9F68] pl-2">
                            <p>• 10:00 飯店出發前往機場</p>
                            <p>• 13:45 <strong>JX742</strong> 返回台北</p>
                        </div>
                        ), 
                        icon: "plane" 
                    },
                    { 
                        time: "09:30", 
                        title: "第二梯次 (JX746)", 
                        desc: (
                        <div className="space-y-2 mt-1 text-sm border-l-2 border-[#0F1C20] pl-2">
                            <p>• 09:30 Central Park 最後血拼</p>
                            <p>• 12:30 午餐 <strong className="cursor-pointer hover:text-[#FF9F68] underline">Aunglo by Yangrak</strong></p>
                            <p>• 14:00 飯店出發前往機場</p>
                            <p>• 17:40 <strong>JX746</strong> 返回台北</p>
                        </div>
                        ), 
                        icon: "shopping-bag",
                        link: "https://maps.app.goo.gl/mn17o6roHwB87Cdy8"
                    }
                ]
            },
        };

        // --- Components ---

        const PillNav = ({ activeTab, setActiveTab }) => {
            return (
                <div className="fixed bottom-6 left-1/2 transform -translate-x-1/2 bg-[#0F1C20] rounded-full px-2 py-2 flex items-center shadow-2xl z-50 max-w-[95vw] overflow-x-auto no-scrollbar">
                    <button 
                        onClick={() => setActiveTab('home')}
                        className={`flex items-center gap-2 px-4 py-3 rounded-full transition-all duration-300 whitespace-nowrap ${activeTab === 'home' ? 'bg-[#FF9F68] text-[#0F1C20] font-bold' : 'text-gray-400 hover:text-white'}`}
                    >
                        <Home size={20} />
                        {activeTab === 'home' && <span>首頁</span>}
                    </button>
                    <button 
                        onClick={() => setActiveTab('schedule')}
                        className={`flex items-center gap-2 px-4 py-3 rounded-full transition-all duration-300 whitespace-nowrap ${activeTab === 'schedule' ? 'bg-[#FF9F68] text-[#0F1C20] font-bold' : 'text-gray-400 hover:text-white'}`}
                    >
                        <Calendar size={20} />
                        {activeTab === 'schedule' && <span>行程</span>}
                    </button>
                    <button 
                        onClick={() => setActiveTab('map')}
                        className={`flex items-center gap-2 px-4 py-3 rounded-full transition-all duration-300 whitespace-nowrap ${activeTab === 'map' ? 'bg-[#FF9F68] text-[#0F1C20] font-bold' : 'text-gray-400 hover:text-white'}`}
                    >
                        <MapIcon size={20} />
                        {activeTab === 'map' && <span>地圖</span>}
                    </button>
                    <button 
                        onClick={() => setActiveTab('hotels')}
                        className={`flex items-center gap-2 px-4 py-3 rounded-full transition-all duration-300 whitespace-nowrap ${activeTab === 'hotels' || activeTab === 'room_list' ? 'bg-[#FF9F68] text-[#0F1C20] font-bold' : 'text-gray-400 hover:text-white'}`}
                    >
                        <MapPin size={20} />
                        {(activeTab === 'hotels' || activeTab === 'room_list') && <span>住宿</span>}
                    </button>
                    <button 
                        onClick={() => setActiveTab('notes')}
                        className={`flex items-center gap-2 px-4 py-3 rounded-full transition-all duration-300 whitespace-nowrap ${activeTab === 'notes' ? 'bg-[#FF9F68] text-[#0F1C20] font-bold' : 'text-gray-400 hover:text-white'}`}
                    >
                        <Info size={20} />
                        {activeTab === 'notes' && <span>須知</span>}
                    </button>
                    <button 
                        onClick={() => setActiveTab('tickets')}
                        className={`flex items-center gap-2 px-4 py-3 rounded-full transition-all duration-300 whitespace-nowrap ${activeTab === 'tickets' ? 'bg-[#FF9F68] text-[#0F1C20] font-bold' : 'text-gray-400 hover:text-white'}`}
                    >
                        <Plane size={20} />
                        {activeTab === 'tickets' && <span>機票</span>}
                    </button>
                </div>
            );
        };

        const Header = ({ title, showBack = false, onBack }) => (
            <div className="flex justify-between items-center mb-6 pt-4 px-2">
                {showBack ? (
                    <button 
                        onClick={onBack}
                        className="p-3 bg-white/20 backdrop-blur-sm rounded-full hover:bg-white/30 transition"
                    >
                        <ChevronLeft size={24} className="text-[#0F1C20]" />
                    </button>
                ) : (
                    <div className="p-3"></div>
                )}
                <h1 className="text-xl font-bold text-[#0F1C20] tracking-wide">{title}</h1>
                <button className="p-3 border border-[#0F1C20]/10 rounded-full hover:bg-white/10 transition">
                    <MoreHorizontal size={24} className="text-[#0F1C20]" />
                </button>
            </div>
        );

        // Custom Hook for Countdown
        const useCountdown = (targetDate) => {
            const [timeLeft, setTimeLeft] = useState({ days: 0, hours: 0, minutes: 0, seconds: 0 });

            const calculateTimeLeft = () => {
                const difference = +new Date(targetDate) - +new Date();
                let timeLeft = {};

                if (difference > 0) {
                    timeLeft = {
                        days: Math.floor(difference / (1000 * 60 * 60 * 24)),
                        hours: Math.floor((difference / (1000 * 60 * 60)) % 24),
                        minutes: Math.floor((difference / 1000 / 60) % 60),
                        seconds: Math.floor((difference / 1000) % 60),
                    };
                } else {
                    timeLeft = { days: 0, hours: 0, minutes: 0, seconds: 0 };
                }
                return timeLeft;
            };

            useEffect(() => {
                setTimeLeft(calculateTimeLeft());
                const timer = setInterval(() => {
                    setTimeLeft(calculateTimeLeft());
                }, 1000);
                return () => clearInterval(timer);
            }, [targetDate]);

            return timeLeft;
        };

        // --- Views ---

        const WeatherCard = () => {
            const [weather, setWeather] = useState(null);
            const [loading, setLoading] = useState(true);

            useEffect(() => {
                const fetchWeather = async () => {
                    try {
                        const response = await fetch(
                            'https://api.open-meteo.com/v1/forecast?latitude=13.7563&longitude=100.5018&current=temperature_2m,relative_humidity_2m,is_day,weather_code,wind_speed_10m&daily=weather_code,temperature_2m_max,temperature_2m_min,sunrise,sunset&timezone=Asia%2FBangkok'
                        );
                        const data = await response.json();
                        setWeather(data);
                        setLoading(false);
                    } catch (error) {
                        console.error("Failed to fetch weather", error);
                        setLoading(false);
                    }
                };

                fetchWeather();
            }, []);

            const getWeatherIcon = (code, size = 16, className = "") => {
                if (code === 0) return <Sun size={size} className={`text-[#FF9F68] ${className}`} />;
                if (code >= 1 && code <= 3) return <Cloud size={size} className={`text-gray-300 ${className}`} />;
                if (code >= 45 && code <= 48) return <Cloud size={size} className={`text-gray-400 ${className}`} />;
                if (code >= 51 && code <= 67) return <CloudRain size={size} className={`text-blue-300 ${className}`} />;
                if (code >= 80 && code <= 99) return <CloudRain size={size} className={`text-blue-400 ${className}`} />;
                return <Sun size={size} className={`text-[#FF9F68] ${className}`} />;
            };

            if (loading) {
                return (
                    <div className="mx-6 mb-8 rounded-[35px] p-6 bg-[#0F1C20] text-white flex justify-center items-center h-[200px] shadow-xl">
                        <RefreshCcw className="animate-spin text-[#FF9F68]" size={32} />
                    </div>
                );
            }

            if (!weather) return null;

            const current = weather.current;
            const daily = weather.daily;
            const today = new Date();
            const monthNames = ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"];
            const formattedDate = `${monthNames[today.getMonth()]} ${today.getFullYear()}`;
            const sunrise = daily.sunrise[0].split('T')[1];
            const sunset = daily.sunset[0].split('T')[1];

            return (
                <div className="mx-6 mb-8 rounded-[35px] p-6 text-white relative overflow-hidden shadow-xl group">
                    <div className="absolute inset-0 bg-gradient-to-br from-[#0F1C20]/90 via-[#1a2e33]/85 to-[#2E5C55]/80 backdrop-blur-xl z-0"></div>
                    <div className="absolute top-[-50%] left-[-20%] w-[200px] h-[200px] bg-[#FF9F68] opacity-20 blur-[80px] rounded-full pointer-events-none"></div>

                    <div className="relative z-10">
                        <div className="flex justify-between items-start mb-6">
                            <div className="flex items-center gap-4">
                                {getWeatherIcon(current.weather_code, 52, "drop-shadow-[0_0_15px_rgba(255,159,104,0.5)]")}
                                <div>
                                    <p className="text-xs font-medium opacity-70 mb-0.5">Current Weather</p>
                                    <h3 className="text-3xl font-bold leading-none">{Math.round(current.temperature_2m)}°C</h3>
                                    <p className="text-sm font-medium opacity-90">Bangkok, Thailand</p>
                                </div>
                            </div>
                            <div className="text-right">
                                <span className="text-xs font-bold bg-white/10 px-2 py-1 rounded-lg backdrop-blur-sm">{formattedDate}</span>
                            </div>
                        </div>

                        <div className="space-y-3 mb-6">
                            <div className="bg-[#0F1C20]/40 rounded-2xl px-4 py-3 flex justify-between items-center text-xs border border-white/5 shadow-inner">
                                <div className="flex items-center gap-2 text-white/90">
                                    <Sun size={16} className="text-[#FF9F68]" /> 
                                    <span>{sunrise}</span>
                                </div>
                                <div className="flex-1 mx-4 h-[2px] bg-white/10 rounded-full relative">
                                    <div className="absolute left-0 top-0 h-full w-[60%] bg-gradient-to-r from-[#FF9F68] to-transparent opacity-50"></div>
                                    <div className="absolute left-[60%] top-1/2 transform -translate-y-1/2 w-2 h-2 bg-white rounded-full shadow-[0_0_5px_white]"></div>
                                </div>
                                <div className="flex items-center gap-2 text-white/90">
                                    <span>{sunset}</span>
                                    <Moon size={16} className="text-[#FF9F68]" />
                                </div>
                            </div>

                            <div className="bg-[#0F1C20]/40 rounded-2xl px-4 py-3 flex items-center justify-between text-xs border border-white/5 shadow-inner">
                                <div className="flex items-center gap-2">
                                    <CloudRain size={16} className="text-blue-300" />
                                    <span className="font-medium">Humidity</span>
                                </div>
                                <span className="font-bold text-blue-200">{current.relative_humidity_2m}%</span>
                            </div>
                        </div>

                        <div className="flex justify-between items-end">
                            <div className="flex flex-col gap-1 text-xs opacity-70 pr-4 border-r border-white/10">
                                <div className="flex items-center gap-1"><Wind size={12}/> {current.wind_speed_10m}km/h</div>
                            </div>

                            <div className="flex-1 flex justify-between pl-4 overflow-x-auto no-scrollbar">
                                {daily.time.slice(1, 6).map((time, i) => {
                                    const dateObj = new Date(time);
                                    const dayName = dateObj.toLocaleDateString('en-US', { weekday: 'short' });
                                    const avgTemp = Math.round((daily.temperature_2m_max[i+1] + daily.temperature_2m_min[i+1]) / 2);
                                    return (
                                        <div key={i} className="flex flex-col items-center gap-1.5 min-w-[36px] opacity-90">
                                            <span className="text-[9px] uppercase tracking-wide">{dayName}</span>
                                            {getWeatherIcon(daily.weather_code[i+1], 16)}
                                            <span className="text-xs">{avgTemp}°</span>
                                        </div>
                                    );
                                })}
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        const HomeView = ({ setActiveTab }) => {
            const timeLeft = useCountdown('2026-02-25T19:45:00');
            const upcomingDay = '2/25';
            const upcomingData = TRIP_DATA[upcomingDay];
            const nextEvent = upcomingData.events[0]; 

            return (
                <div className="animate-fade-in pb-24">
                    <div className="px-6 mb-8">
                        <h2 className="text-4xl font-bold text-[#0F1C20] leading-tight mb-2">
                            Discover <br/>
                            Thailand <span className="italic font-serif font-light">with us!</span>
                        </h2>
                        <div className="flex items-center gap-2 text-[#0F1C20]/60 mt-2 font-medium">
                            <Users size={18} />
                            <span>13 人親友團</span>
                            <span className="mx-2">•</span>
                            <span>2026.02.25 - 03.02</span>
                        </div>
                    </div>

                    <div className="mx-6 mb-8 bg-[#0F1C20] rounded-[30px] p-6 text-white shadow-xl relative overflow-hidden">
                        <div className="absolute top-0 right-0 w-32 h-32 bg-[#FF9F68] rounded-full filter blur-[60px] opacity-20"></div>
                        <h3 className="text-lg text-gray-400 mb-4">距離桃園機場集合還有</h3>
                        <div className="flex justify-between items-end">
                            <div className="text-center flex-1">
                                <span className="text-2xl sm:text-3xl font-bold text-[#FF9F68]">{timeLeft.days || 0}</span>
                                <p className="text-[10px] sm:text-xs text-gray-500 uppercase tracking-wider mt-1">Days</p>
                            </div>
                            <div className="text-xl sm:text-2xl font-light text-gray-600 mb-4">:</div>
                            <div className="text-center flex-1">
                                <span className="text-2xl sm:text-3xl font-bold text-white">{timeLeft.hours || 0}</span>
                                <p className="text-[10px] sm:text-xs text-gray-500 uppercase tracking-wider mt-1">Hrs</p>
                            </div>
                            <div className="text-xl sm:text-2xl font-light text-gray-600 mb-4">:</div>
                            <div className="text-center flex-1">
                                <span className="text-2xl sm:text-3xl font-bold text-white">{timeLeft.minutes || 0}</span>
                                <p className="text-[10px] sm:text-xs text-gray-500 uppercase tracking-wider mt-1">Mins</p>
                            </div>
                            <div className="text-xl sm:text-2xl font-light text-gray-600 mb-4">:</div>
                            <div className="text-center flex-1">
                                <span className="text-2xl sm:text-3xl font-bold text-[#FF9F68] w-8 inline-block text-center tabular-nums">
                                    {String(timeLeft.seconds || 0).padStart(2, '0')}
                                </span>
                                <p className="text-[10px] sm:text-xs text-gray-500 uppercase tracking-wider mt-1">Secs</p>
                            </div>
                        </div>
                    </div>

                    <WeatherCard />

                    <div className="mb-4 px-6">
                        <div className="flex justify-between items-end mb-4">
                            <h3 className="text-xl font-bold text-[#0F1C20]">行程預覽 (Up Next)</h3>
                            <span 
                                onClick={() => setActiveTab('schedule')} 
                                className="text-sm text-[#FF9F68] font-bold cursor-pointer flex items-center gap-1"
                            >
                                Full Schedule <ArrowRight size={14}/>
                            </span>
                        </div>

                        <div 
                            onClick={() => setActiveTab('schedule')}
                            className="bg-white rounded-[30px] p-6 shadow-lg border border-gray-100 relative overflow-hidden group cursor-pointer hover:shadow-xl transition-all"
                        >
                            <div className="absolute top-0 right-0 w-24 h-24 bg-[#C4E0E0] rounded-full blur-[40px] opacity-50 group-hover:opacity-80 transition-opacity"></div>
                            
                            <div className="relative z-10">
                                <div className="flex items-center justify-between mb-4">
                                    <div className="flex items-center gap-2">
                                        <span className="bg-[#FF9F68] text-[#0F1C20] text-xs font-bold px-2 py-1 rounded-lg">
                                            Day 1 • {upcomingDay}
                                        </span>
                                        <span className="text-gray-400 text-xs font-medium">Starting Soon</span>
                                    </div>
                                    <div className="bg-[#0F1C20] p-2 rounded-full text-white">
                                        {upcomingData.icon}
                                    </div>
                                </div>

                                <h2 className="text-2xl font-bold text-[#0F1C20] mb-1">{upcomingData.title}</h2>
                                <p className="text-gray-500 text-sm mb-6">{upcomingData.desc}</p>

                                <div className="bg-[#F5F7F7] rounded-2xl p-4 flex items-start gap-4">
                                    <div className="bg-white w-12 h-12 rounded-xl flex flex-col items-center justify-center shadow-sm shrink-0 border border-gray-100">
                                        <span className="text-[10px] text-gray-400 font-bold">TIME</span>
                                        <span className="text-[#0F1C20] font-bold">{nextEvent.time}</span>
                                    </div>
                                    <div className="flex-1">
                                        <h4 className="text-[#0F1C20] font-bold text-sm">{nextEvent.title}</h4>
                                        <p className="text-gray-500 text-xs mt-1 line-clamp-2">{nextEvent.desc}</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        const ScheduleView = () => {
            const [selectedDay, setSelectedDay] = useState('2/25');

            const days = [
                { date: '2/25', day: 'Wed', active: selectedDay === '2/25' },
                { date: '2/26', day: 'Thu', active: selectedDay === '2/26' },
                { date: '2/27', day: 'Fri', active: selectedDay === '2/27' },
                { date: '2/28', day: 'Sat', active: selectedDay === '2/28' },
                { date: '3/1', day: 'Sun', active: selectedDay === '3/1' },
                { date: '3/2', day: 'Mon', active: selectedDay === '3/2' },
            ];

            const currentData = TRIP_DATA[selectedDay] || { title: "Coming Soon", desc: "Details to be added", icon: <Clock size={20}/>, events: [] };

            return (
                <div className="animate-fade-in px-6 pb-24">
                    <h2 className="text-3xl font-bold text-[#0F1C20] mb-6">Itinerary</h2>
                    
                    <div className="flex gap-3 overflow-x-auto pb-6 no-scrollbar">
                        {days.map((item, idx) => (
                            <div 
                                key={idx} 
                                onClick={() => setSelectedDay(item.date)}
                                className={`flex flex-col items-center justify-center min-w-[70px] h-[90px] rounded-[24px] border transition-all cursor-pointer ${item.active ? 'bg-[#0F1C20] text-white border-[#0F1C20]' : 'bg-white border-transparent text-gray-400'}`}
                            >
                                <span className="text-xs font-medium mb-1">{item.day}</span>
                                <span className="text-xl font-bold">{item.date}</span>
                            </div>
                        ))}
                    </div>

                    <div className="space-y-4">
                        <div className="bg-[#FF9F68] rounded-[30px] p-6 text-[#0F1C20] relative overflow-hidden min-h-[400px]">
                            <div className="absolute -right-4 -top-4 w-24 h-24 bg-white/20 rounded-full blur-xl"></div>
                            
                            <div className="flex justify-between items-start mb-8 relative z-10">
                                <div>
                                    <p className="font-bold opacity-70">{currentData.desc}</p>
                                    <h3 className="text-2xl font-bold mt-1">{currentData.title}</h3>
                                </div>
                                <div className="bg-[#0F1C20] w-12 h-12 rounded-full flex items-center justify-center text-white">
                                    {currentData.icon}
                                </div>
                            </div>
                            
                            <div className="space-y-6 relative z-10">
                                {currentData.events.map((event, idx) => (
                                    <div key={idx} className="flex gap-4 items-start group">
                                        <div className="w-14 font-bold text-right shrink-0 pt-1">{event.time}</div>
                                        <div className={`flex-1 pb-4 ${idx !== currentData.events.length - 1 ? 'border-l-2 border-[#0F1C20]/20' : ''} pl-4 relative`}>
                                            <div className={`absolute -left-[9px] top-1 w-4 h-4 rounded-full ${idx === 0 ? 'bg-[#0F1C20]' : 'bg-white border-2 border-[#0F1C20]'}`}></div>
                                            <h4 className="font-bold text-lg leading-tight">{event.title}</h4>
                                            <div className="text-sm opacity-80 mt-1">{event.desc}</div>
                                            {event.link && (
                                                <a href={event.link} target="_blank" rel="noopener noreferrer" className="inline-flex items-center gap-1 mt-2 text-xs font-bold bg-white/30 px-2 py-1 rounded-full hover:bg-white/50 transition-colors">
                                                    Open Map <ArrowRight size={10} />
                                                </a>
                                            )}
                                        </div>
                                    </div>
                                ))}
                                
                                {currentData.events.length === 0 && (
                                    <div className="text-center opacity-60 py-10">
                                        尚未更新詳細行程
                                    </div>
                                )}
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        const RoomAllocationView = ({ hotel }) => {
            let hotelName = "The Standard Hua Hin";
            let hotelGuests = "Total 7 Rooms • 13 Guests";
            let headerColor = "bg-[#FF9F68]";
            let rooms = [
                { id: 1, type: "Standard King Room", name: "Tang", beds: "1 King Bed", guests: "1 Pax", icon: <BedDouble size={24} />, desc: "豪華特大床，適合情侶或夫妻。" },
                { id: 2, type: "Standard Twin Room", name: "品謙", beds: "2 Double Beds", guests: "1 Pax", icon: <Users size={24} />, desc: "兩張雙人床，空間寬敞。" },
                { id: 3, type: "Standard Twin Room", name: "chen + 鮪魚", beds: "2 Double Beds", guests: "2 Pax", icon: <Users size={24} />, desc: "兩張雙人床，空間寬敞。" },
                { id: 4, type: "Standard Twin Room", name: "青青 + 卉", beds: "2 Double Beds", guests: "2 Pax", icon: <Users size={24} />, desc: "兩張雙人床，空間寬敞。" },
                { id: 5, type: "Standard Twin Room", name: "珮 + 王八八", beds: "2 Double Beds", guests: "2 Pax", icon: <Users size={24} />, desc: "兩張雙人床，空間寬敞。" },
                { id: 6, type: "Standard Twin Room", name: "蜜莉 + 一涵", beds: "2 Double Beds", guests: "2 Pax", icon: <Users size={24} />, desc: "兩張雙人床，空間寬敞。" },
                { id: 7, type: "Standard Twin Room", name: "Yee、靖榆、ㄓ", beds: "2 Double Beds", guests: "3 Pax", icon: <Users size={24} />, desc: "兩張雙人床，空間寬敞。" },
            ];

            if (hotel === 'asai') {
                hotelName = "ASAI Bangkok Chinatown";
                headerColor = "bg-[#C4E0E0]"; 
                rooms = [
                    { id: 1, type: "Comfy Twin Room", name: "品謙 + 王八八", beds: "2 Single Beds", guests: "2 Pax", icon: <Users size={24} />, desc: "舒適雙床，飽覽城市景觀。" },
                    { id: 2, type: "Comfy Twin Room", name: "chen + 青青", beds: "2 Single Beds", guests: "2 Pax", icon: <Users size={24} />, desc: "舒適雙床，飽覽城市景觀。" },
                    { id: 3, type: "Comfy Twin Room", name: "珮 + 卉", beds: "2 Single Beds", guests: "2 Pax", icon: <Users size={24} />, desc: "舒適雙床，飽覽城市景觀。" },
                    { id: 4, type: "Comfy Twin Room", name: "ㄓ + 鮪魚", beds: "2 Single Beds", guests: "2 Pax", icon: <Users size={24} />, desc: "舒適雙床，飽覽城市景觀。" },
                    { id: 5, type: "Comfy Twin Room", name: "蜜莉 + 一涵", beds: "2 Single Beds", guests: "2 Pax", icon: <Users size={24} />, desc: "舒適雙床，飽覽城市景觀。" },
                    { id: 6, type: "Roomy Triple Room", name: "Tang、Yee、靖榆", beds: "2 Single + 1 Bunk", guests: "3 Pax", icon: <Users size={24} />, desc: "寬敞三人房（2張單人床 及 1張上舖）" },
                ];
                hotelGuests = `Total ${rooms.length} Rooms • 13 Guests`;
            }

            return (
                <div className="animate-fade-in px-6 pb-24">
                    <div className="flex justify-between items-end mb-6">
                        <h2 className="text-3xl font-bold text-[#0F1C20] leading-none">
                            Room <br/> Allocation <span className="italic font-serif font-light">List</span>
                        </h2>
                        <div className="p-3 border border-gray-300 rounded-full">
                            <Key size={20} className="text-[#0F1C20]"/>
                        </div>
                    </div>

                    <div className={`${headerColor} rounded-2xl p-4 mb-6 shadow-sm`}>
                        <h3 className="font-bold text-[#0F1C20] flex items-center gap-2">
                            <Home size={18} /> {hotelName}
                        </h3>
                        <p className="text-[#0F1C20]/80 text-sm mt-1">{hotelGuests}</p>
                    </div>

                    <div className="space-y-3">
                        {rooms.map((room) => (
                            <div key={room.id} className="bg-white rounded-[24px] p-5 flex items-center gap-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow">
                                <div className="w-12 h-12 rounded-full bg-[#F5F7F7] flex items-center justify-center text-[#0F1C20] shrink-0">
                                    {room.icon}
                                </div>
                                <div className="flex-1">
                                    <div className="flex justify-between items-center mb-1">
                                        <h4 className="font-bold text-[#0F1C20]">Room {room.id}</h4>
                                        <span className={`text-[10px] font-bold px-2 py-1 rounded-full ${room.id === 1 && hotel !== 'asai' ? 'bg-[#0F1C20] text-white' : 'bg-[#FF9F68]/20 text-[#FF9F68]'}`}>
                                            {room.type.includes('King') || room.type.includes('Triple') ? (room.type.includes('Triple') ? 'Triple' : 'King') : 'Twin'}
                                        </span>
                                    </div>
                                    <p className="text-sm text-gray-600 font-medium">{room.name}</p>
                                    <p className="text-xs text-gray-400 mt-0.5">{room.beds} • {room.guests}</p>
                                </div>
                            </div>
                        ))}
                    </div>
                </div>
            );
        };

        const HotelsView = ({ onViewRooms }) => {
            const openMap = (hotelName) => {
                const query = encodeURIComponent(hotelName);
                window.open(`https://www.google.com/maps/search/?api=1&query=${query}`, '_blank');
            };

            return (
                <div className="animate-fade-in px-6 pb-24">
                    <div className="flex justify-between items-end mb-6">
                        <h2 className="text-3xl font-bold text-[#0F1C20] leading-none">
                            Your <br/> Hotels <span className="italic font-serif font-light">Booked</span>
                        </h2>
                        <div className="p-3 border border-gray-300 rounded-full">
                            <MapPin size={20} className="text-[#0F1C20]"/>
                        </div>
                    </div>

                    <div className="mb-6">
                        <div 
                            onClick={() => openMap("SHIN Patara Living Hotel Bangkok")}
                            className="bg-[#FF9F68] rounded-[24px] p-5 flex justify-between items-center cursor-pointer transition hover:bg-[#ff8a50] hover:shadow-md"
                        >
                            <div>
                                <div className="flex items-center gap-2 mb-1">
                                    <span className="bg-[#0F1C20] text-white text-[10px] px-2 py-0.5 rounded-full">Stop 1 • Arrival</span>
                                </div>
                                <h4 className="font-bold text-[#0F1C20] text-lg">SHIN Patara Living</h4>
                                <p className="text-[#0F1C20]/70 text-sm">Feb 26 (01:15 AM check-in)</p>
                            </div>
                            <MapIcon size={20} className="text-[#0F1C20]" />
                        </div>
                    </div>

                    <div 
                        className="w-full aspect-[4/5] rounded-[40px] bg-[#0F1C20] relative mb-6 overflow-hidden group hover:shadow-xl transition-all"
                    >
                        <div 
                            onClick={() => openMap("The Standard Hua Hin")}
                            className="absolute inset-0 cursor-pointer"
                        >
                            <img 
                                src="https://assets.hyatt.com/content/dam/hyatt/hyattdam/images/2025/05/16/1025/HUASH-P0016-Pool.jpg/HUASH-P0016-Pool.16x9.jpg" 
                                alt="The Standard Hua Hin Pool" 
                                className="w-full h-full object-cover opacity-80 transition-transform duration-500 group-hover:scale-105" 
                            />
                            <div className="absolute inset-0 bg-gradient-to-t from-black/60 via-black/20 to-transparent"></div>
                        </div>
                        
                        <div className="absolute top-6 left-6 right-6 flex justify-between items-start z-10 pointer-events-none">
                            <div>
                                <div className="flex items-center gap-2 mb-1">
                                    <span className="bg-[#C4E0E0] text-[#0F1C20] text-[10px] font-bold px-2 py-0.5 rounded-full">Stop 2</span>
                                </div>
                                <h3 className="text-3xl font-bold text-white leading-tight drop-shadow-lg">The Standard<br/>Hua Hin</h3>
                                <p className="text-white/90 font-medium drop-shadow-md">Feb 26 - 28</p>
                            </div>
                            <button className="w-12 h-12 bg-[#C4E0E0]/90 backdrop-blur rounded-full flex items-center justify-center text-[#0F1C20] shadow-lg pointer-events-auto">
                                <MapIcon size={20} />
                            </button>
                        </div>

                        <div className="absolute bottom-6 left-6 right-6 z-10 flex gap-2">
                            <button 
                                onClick={(e) => {
                                    e.stopPropagation(); 
                                    onViewRooms('huahin');
                                }}
                                className="flex-1 bg-white text-[#0F1C20] font-bold py-4 rounded-[20px] shadow-lg hover:bg-gray-50 transition-colors flex items-center justify-center gap-2"
                            >
                                <Key size={18} />
                                查看分房
                            </button>
                        </div>
                    </div>

                    <div 
                        className="w-full aspect-[4/5] rounded-[40px] bg-[#0F1C20] relative mb-6 overflow-hidden group hover:shadow-xl transition-all"
                    >
                        <div 
                            onClick={() => openMap("ASAI Bangkok Chinatown")}
                            className="absolute inset-0 cursor-pointer"
                        >
                            <div className="w-full h-full bg-gray-800 relative">
                                <img 
                                    src="https://www.dusit.com/asai-bangkok-chinatown/wp-content/uploads/sites/51/cache/2025/03/ABCT-WEBSITE-2/573589606.jpg" 
                                    onError={(e) => {e.target.src = "/api/placeholder/400/500"; e.target.style.opacity="0.5"}}
                                    alt="ASAI Chinatown" 
                                    className="w-full h-full object-cover opacity-80 transition-transform duration-500 group-hover:scale-105" 
                                />
                            </div>
                            <div className="absolute inset-0 bg-gradient-to-t from-black/60 via-black/20 to-transparent"></div>
                        </div>
                        
                        <div className="absolute top-6 left-6 right-6 flex justify-between items-start z-10 pointer-events-none">
                            <div>
                                <div className="flex items-center gap-2 mb-1">
                                    <span className="bg-[#FF9F68] text-[#0F1C20] text-[10px] font-bold px-2 py-0.5 rounded-full">Stop 3</span>
                                </div>
                                <h3 className="text-3xl font-bold text-white leading-tight drop-shadow-lg">ASAI<br/>Chinatown</h3>
                                <p className="text-white/90 font-medium drop-shadow-md">Feb 28 - Mar 2</p>
                            </div>
                            <button className="w-12 h-12 bg-[#FF9F68]/90 backdrop-blur rounded-full flex items-center justify-center text-[#0F1C20] shadow-lg pointer-events-auto">
                                <MapIcon size={20} />
                            </button>
                        </div>

                        <div className="absolute bottom-6 left-6 right-6 z-10 flex gap-2">
                            <button 
                                onClick={(e) => {
                                    e.stopPropagation(); 
                                    onViewRooms('asai');
                                }}
                                className="flex-1 bg-white text-[#0F1C20] font-bold py-4 rounded-[20px] shadow-lg hover:bg-gray-50 transition-colors flex items-center justify-center gap-2"
                            >
                                <Key size={18} />
                                查看分房
                            </button>
                        </div>
                    </div>

                </div>
            );
        };

        const FlightTicket = ({ flight, defaultExpanded }) => {
            const [isExpanded, setIsExpanded] = useState(defaultExpanded);
            const [flightStatus, setFlightStatus] = useState({
                status: 'Scheduled',
                gate: 'TBA',
                terminal: '1',
                estimatedDep: flight.scheduledDep,
                estimatedArr: flight.scheduledArr,
                lastUpdated: null,
                loading: false,
                isRealData: false,
                error: null
            });

            const fetchFlightData = async () => {
                if (!flight.flightNum) return;
                
                setFlightStatus(prev => ({ ...prev, loading: true, error: null }));
                
                const API_KEY = '3f8352e5-12ae-4c99-86ba-7d451ec11900';
                const FLIGHT_IATA = flight.flightNum;

                try {
                    const response = await fetch(`https://airlabs.co/api/v9/flight?flight_iata=${FLIGHT_IATA}&api_key=${API_KEY}`);
                    
                    if (!response.ok) {
                        throw new Error('API Response not ok');
                    }

                    const data = await response.json();
                    
                    const now = new Date();
                    const updatedTime = `${now.getHours().toString().padStart(2, '0')}:${now.getMinutes().toString().padStart(2, '0')}`;

                    if (data.response && data.response.length > 0) {
                        const flightData = data.response[0];
                        
                        let uiStatus = 'Scheduled';
                        if (flightData.status === 'en-route' || flightData.status === 'active') uiStatus = 'On Time';
                        if (flightData.status === 'landed') uiStatus = 'Arrived';
                        if (flightData.status === 'scheduled') uiStatus = 'Scheduled';
                        if (flightData.status === 'cancelled') uiStatus = 'Cancelled';
                        if (flightData.dep_delayed > 15) uiStatus = 'Delayed';

                        let estDep = flightData.dep_estimated || flightData.dep_time || flight.scheduledDep;
                        if (estDep.includes(' ')) estDep = estDep.split(' ')[1].substring(0, 5);

                        let estArr = flightData.arr_estimated || flightData.arr_time || flight.scheduledArr;
                        if (estArr.includes(' ')) estArr = estArr.split(' ')[1].substring(0, 5);

                        setFlightStatus({
                            status: uiStatus,
                            gate: flightData.dep_gate || 'TBA',
                            terminal: flightData.dep_terminal || '1',
                            estimatedDep: estDep,
                            estimatedArr: estArr,
                            lastUpdated: updatedTime,
                            loading: false,
                            isRealData: true,
                            error: null
                        });
                    } else {
                        setFlightStatus(prev => ({
                            ...prev,
                            lastUpdated: updatedTime,
                            loading: false,
                            isRealData: false, 
                            error: "Flight not active"
                        }));
                    }

                } catch (err) {
                    console.error("AirLabs fetch error:", err);
                    const now = new Date();
                    const updatedTime = `${now.getHours().toString().padStart(2, '0')}:${now.getMinutes().toString().padStart(2, '0')}`;
                    setFlightStatus(prev => ({
                        ...prev,
                        lastUpdated: updatedTime,
                        loading: false,
                        isRealData: false,
                        error: "Connection failed"
                    }));
                }
            };

            useEffect(() => {
                fetchFlightData();
            }, []);

            const getStatusColor = (status) => {
                switch(status) {
                    case 'On Time': return 'text-green-500';
                    case 'Arrived': return 'text-green-600';
                    case 'Delayed': return 'text-red-500';
                    case 'Cancelled': return 'text-red-600';
                    case 'Boarding': return 'text-[#FF9F68] animate-pulse';
                    default: return 'text-white';
                }
            };

            return (
                <div className="bg-white rounded-[35px] overflow-hidden shadow-xl flex flex-col relative w-full max-w-md mx-auto transition-all duration-300">
                    <div 
                        onClick={() => setIsExpanded(!isExpanded)}
                        className={`bg-[#0F1C20] p-8 text-white relative cursor-pointer transition-all duration-300 ${!isExpanded ? 'pb-8' : ''}`}
                    >
                        <div className="flex justify-between items-start mb-6">
                            <span className="text-[#FF9F68] font-bold text-sm tracking-wider uppercase border border-[#FF9F68] px-2 py-0.5 rounded-full">
                                {flight.type}
                            </span>
                            
                            <div className="flex flex-col items-end gap-3">
                                <div className="flex gap-3 items-center">
                                    <button 
                                        onClick={(e) => { e.stopPropagation(); fetchFlightData(); }}
                                        className={`p-1.5 rounded-full bg-white/20 hover:bg-white text-white hover:text-[#0F1C20] transition-all ${flightStatus.loading ? 'animate-spin' : ''}`}
                                    >
                                        <RefreshCcw size={14} />
                                    </button>
                                    {isExpanded ? <ChevronUp className="text-gray-400" /> : <ChevronDown className="text-gray-400" />}
                                </div>

                                {isExpanded && (
                                    <div className="flex items-center gap-2 bg-black/30 px-3 py-1 rounded-full backdrop-blur-sm border border-white/10">
                                        <div className={`w-2 h-2 rounded-full ${flightStatus.isRealData ? 'bg-green-500' : 'bg-gray-400'} ${flightStatus.isRealData ? 'animate-pulse' : ''} shadow-[0_0_8px_rgba(34,197,94,0.6)]`}></div>
                                        <span className="text-[10px] font-bold tracking-wider uppercase whitespace-nowrap">
                                            {flightStatus.isRealData ? 'Live' : 'Scheduled'}
                                        </span>
                                    </div>
                                )}
                            </div>
                        </div>

                        <div className="flex justify-between items-start mb-4 mt-2">
                            <div>
                                <p className="text-gray-400 text-xs font-bold uppercase tracking-widest mb-1">Airline</p>
                                <p className="text-xl font-bold text-[#FF9F68]">{flight.airline}</p>
                            </div>
                            <div className="text-right"> 
                                <p className="text-gray-400 text-xs font-bold uppercase tracking-widest mb-1">Flight</p>
                                <p className="text-3xl font-bold">{flight.flightNum}</p>
                            </div>
                        </div>

                        <div className="flex justify-between items-center mb-4">
                            <div className="text-xs text-gray-400">{flight.date}</div>
                            <div className={`text-sm font-bold ${getStatusColor(flightStatus.status)} flex items-center gap-1`}>
                                {flightStatus.status}
                                {(flightStatus.status === 'On Time' || flightStatus.status === 'Arrived') && <CheckSquare size={12} />}
                            </div>
                            <div className="text-xs text-gray-400">{flight.duration}</div>
                        </div>
                        
                        <div className="flex items-center justify-between relative mb-2">
                            <div className="w-3 h-3 bg-[#FF9F68] rounded-full z-10"></div>
                            <div className="h-[2px] bg-gray-700 w-full absolute top-1/2 left-0"></div>
                            <div className="w-3 h-3 bg-[#FF9F68] rounded-full z-10"></div>
                        </div>

                        <div className="flex justify-between text-lg font-bold tracking-wide">
                            <span>{flight.origin}</span>
                            <span>{flight.dest}</span>
                        </div>
                        
                        <div className="flex justify-between text-xs text-gray-400 mt-1">
                            <div>
                                <span className="block text-gray-500 mb-1">{isExpanded ? 'Scheduled' : 'Departs'}</span>
                                <span className="text-white font-bold text-sm">{flightStatus.estimatedDep}</span>
                            </div>
                            <div className="text-right">
                                <span className="block text-gray-500 mb-1">{isExpanded ? 'Estimated' : 'Arrives'}</span>
                                <span className={`text-sm font-bold ${flightStatus.status === 'Delayed' ? 'text-red-400' : 'text-white'}`}>
                                    {flightStatus.estimatedArr} (+1)
                                </span>
                            </div>
                        </div>

                        {isExpanded && (
                            <>
                                <div className="absolute -bottom-4 -left-4 w-8 h-8 bg-[#C4E0E0] rounded-full z-20"></div>
                                <div className="absolute -bottom-4 -right-4 w-8 h-8 bg-[#C4E0E0] rounded-full z-20"></div>
                            </>
                        )}
                    </div>

                    <div className={`transition-all duration-300 ease-in-out overflow-hidden ${isExpanded ? 'max-h-[500px] opacity-100' : 'max-h-0 opacity-0'}`}>
                        <div className="h-8 bg-white relative flex items-center justify-center">
                            <div className="w-[90%] border-t-2 border-dashed border-gray-300"></div>
                        </div>

                        <div className="bg-white p-8 pt-2">
                            <div className="flex justify-between items-center mb-4">
                                <div>
                                    <p className="text-gray-400 text-xs font-bold uppercase">Terminal</p>
                                    <p className="text-[#0F1C20] font-bold text-lg">{flightStatus.terminal}</p>
                                </div>
                                <div className="text-right">
                                    <p className="text-gray-400 text-xs font-bold uppercase">Gate</p>
                                    <p className="text-[#0F1C20] font-bold text-2xl animate-pulse text-indigo-600">
                                        {flightStatus.loading ? '...' : flightStatus.gate}
                                    </p>
                                </div>
                                <div className="text-right">
                                    <p className="text-gray-400 text-xs font-bold uppercase">Meeting</p>
                                    <p className="text-red-500 font-bold text-lg">{flight.meetingTime}</p>
                                </div>
                            </div>
                            
                            <div className="bg-gray-50 p-3 rounded-xl border border-gray-100 flex items-center gap-3 mb-6">
                                <div className="bg-blue-100 p-2 rounded-full text-blue-600">
                                    {flightStatus.error ? <Wifi size={16} className="text-red-500" /> : <AlertCircle size={16} />}
                                </div>
                                <div className="text-xs text-gray-600">
                                    <span className="font-bold text-[#0F1C20] block mb-0.5">Note</span>
                                    {flight.note}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        const TicketView = () => {
            const flights = [
                {
                    type: '去程 Departure',
                    airline: 'Thai Lion Air',
                    flightNum: 'SL395',
                    date: '2026.02.25',
                    origin: 'TPE',
                    dest: 'DMK',
                    scheduledDep: '21:15',
                    scheduledArr: '00:15',
                    duration: '04h 00m',
                    meetingTime: '19:45',
                    note: 'No Online Check-in available. (Flight not currently active in sim)',
                    noCheckIn: true
                },
                {
                    type: '回程 Return (G1)',
                    airline: 'Starlux',
                    flightNum: 'JX742',
                    date: '2026.03.02',
                    origin: 'BKK',
                    dest: 'TPE',
                    scheduledDep: '13:45',
                    scheduledArr: '18:30', // Estimate
                    duration: '03h 45m', 
                    meetingTime: '10:00',
                    note: 'Group 1 Departure (Hotel -> Airport)'
                },
                {
                    type: '回程 Return (G2)',
                    airline: 'Starlux',
                    flightNum: 'JX746',
                    date: '2026.03.02',
                    origin: 'BKK',
                    dest: 'TPE',
                    scheduledDep: '17:40',
                    scheduledArr: '22:20', // Estimate
                    duration: '03h 40m', 
                    meetingTime: '14:00',
                    note: 'Group 2 Departure (Hotel -> Airport)'
                }
            ];

            return (
                <div className="animate-fade-in px-6 pb-24 h-full flex flex-col">
                    <div className="flex justify-between items-center mb-6">
                        <h2 className="text-3xl font-bold text-[#0F1C20]">Your Tickets</h2>
                    </div>

                    <div className="space-y-6">
                        {flights.map((flight, idx) => (
                            <FlightTicket 
                                key={idx} 
                                flight={flight} 
                                defaultExpanded={idx === 0} 
                            />
                        ))}
                    </div>
                </div>
            );
        };

        const NotesView = () => {
            const [checklist, setChecklist] = useState([
                { id: 1, text: "檢查護照效期 (至少 6 個月以上！)", checked: false },
                { id: 2, text: "先跟主管請假 / 告知", checked: false },
                { id: 3, text: "在台灣先註冊 Grab / Line Pay", checked: false },
                { id: 4, text: "準備換匯現金 (台幣 / 美金皆可)", checked: false },
                { id: 5, text: "提早準備個人藥品 (過敏、止瀉藥等)", checked: false },
                { id: 6, text: "泰國網卡 / 漫遊", checked: false },
                { id: 7, text: "泳衣 (華欣飯店泳池)", checked: false },
                { id: 8, text: "防曬乳 / 墨鏡 / 帽子", checked: false },
            ]);

            const toggleCheck = (id) => {
                setChecklist(checklist.map(item => 
                    item.id === id ? { ...item, checked: !item.checked } : item
                ));
            };

            const infoCards = [
                {
                    title: "天氣 Weather",
                    icon: <Thermometer className="text-[#FF9F68]" />,
                    content: "2月-3月是泰國乾季偏熱，平均氣溫 25-34°C。建議穿著透氣衣物。",
                    bgColor: "bg-[#0F1C20]",
                    textColor: "text-white"
                },
                {
                    title: "電壓 Voltage",
                    icon: <Zap className="text-[#FF9F68]" />,
                    content: "220V，插座通常通用台灣雙扁插頭 (Type A/C)，不需轉接頭，但需注意電壓。",
                    bgColor: "bg-white",
                    textColor: "text-[#0F1C20]"
                },
                {
                    title: "匯率 Currency",
                    icon: <Banknote className="text-[#FF9F68]" />,
                    content: "出發去華欣前，會派小分隊去換匯(供華欣使用)。建議帶台幣或美金(匯率較佳)。回曼谷不夠可再換。",
                    bgColor: "bg-white",
                    textColor: "text-[#0F1C20]"
                },
                {
                    title: "緊急聯絡 Emergency",
                    icon: <Phone className="text-[#FF9F68]" />,
                    content: "觀光警察: 1155\n救護車: 1669\n台灣駐泰辦事處: +66-81-666-4006",
                    bgColor: "bg-[#FF9F68]",
                    textColor: "text-[#0F1C20]"
                }
            ];

            return (
                <div className="animate-fade-in px-6 pb-24">
                    {/* TDAC Alert Button */}
                    <a 
                        href="https://tdac.immigration.go.th/arrival-card/#/home" 
                        target="_blank" 
                        rel="noopener noreferrer"
                        className="block bg-blue-600 rounded-[24px] p-5 mb-8 shadow-lg transform transition-transform hover:scale-[1.02] active:scale-95 relative overflow-hidden group"
                    >
                        <div className="absolute -right-4 -top-4 w-20 h-20 bg-blue-400 rounded-full opacity-20 blur-xl"></div>
                        <div className="absolute -left-4 -bottom-4 w-16 h-16 bg-white rounded-full opacity-10 blur-lg"></div>

                        <div className="relative z-10">
                            <div className="flex justify-between items-start mb-2">
                                <div className="flex items-center gap-2 text-white">
                                    <FileText size={24} className="animate-pulse"/>
                                    <h3 className="text-xl font-bold">泰國數位入境卡 (TDAC)</h3>
                                </div>
                                <ExternalLink size={18} className="text-blue-200" />
                            </div>
                            
                            <p className="text-blue-50 text-sm mb-3 leading-relaxed font-medium">
                                請點此填寫。出發前 72 小時內開放。
                            </p>
                            
                            <div className="bg-blue-800/30 rounded-xl p-3 border border-blue-400/30 flex gap-3 items-start">
                                <AlertCircle size={16} className="text-blue-200 shrink-0 mt-0.5" />
                                <p className="text-xs text-blue-100">
                                    最晚需於登機前完成，避免到機場因未填寫而耽誤行程。
                                </p>
                            </div>
                        </div>
                    </a>

                    <h2 className="text-3xl font-bold text-[#0F1C20] mb-6">Important Info</h2>

                    {/* Info Grid */}
                    <div className="grid grid-cols-2 gap-4 mb-8">
                        {infoCards.map((card, idx) => (
                            <div key={idx} className={`${card.bgColor} rounded-[24px] p-5 shadow-sm flex flex-col justify-between min-h-[160px]`}>
                                <div className="flex justify-between items-start">
                                    <div className={`p-2 rounded-full ${card.bgColor === 'bg-white' ? 'bg-gray-100' : 'bg-white/10'}`}>
                                        {card.icon}
                                    </div>
                                </div>
                                <div>
                                    <h4 className={`font-bold text-sm mb-1 ${card.textColor}`}>{card.title}</h4>
                                    <p className={`text-xs opacity-80 whitespace-pre-line ${card.textColor}`}>{card.content}</p>
                                </div>
                            </div>
                        ))}
                    </div>

                    {/* Checklist Section */}
                    <div className="bg-white rounded-[30px] p-6 shadow-sm">
                        <div className="flex items-center gap-3 mb-4">
                            <div className="bg-[#C4E0E0] p-2 rounded-full text-[#0F1C20]">
                                <CheckSquare size={20} />
                            </div>
                            <h3 className="text-xl font-bold text-[#0F1C20]">To-Do List</h3>
                        </div>
                        
                        <div className="space-y-3">
                            {checklist.map((item) => (
                                <div 
                                    key={item.id} 
                                    onClick={() => toggleCheck(item.id)}
                                    className="flex items-center gap-4 p-3 rounded-xl hover:bg-gray-50 cursor-pointer transition"
                                >
                                    <div className={`w-6 h-6 rounded-full border-2 flex items-center justify-center transition-colors shrink-0 ${item.checked ? 'bg-[#FF9F68] border-[#FF9F68]' : 'border-gray-300'}`}>
                                        {item.checked && <CheckSquare size={14} className="text-white" />}
                                    </div>
                                    <span className={`flex-1 font-medium ${item.checked ? 'text-gray-400 line-through' : 'text-[#0F1C20]'}`}>
                                        {item.text}
                                    </span>
                                </div>
                            ))}
                        </div>
                    </div>
                </div>
            );
        };

        const MapView = () => {
            const maps = [
                {
                    title: "美食地圖 Food Guide",
                    desc: "精選曼谷必吃餐廳 & 街頭小吃",
                    url: "https://maps.app.goo.gl/tg2TQGomWeauXkN66",
                    color: "bg-[#FF9F68]",
                    textColor: "text-[#0F1C20]",
                    icon: <Utensils size={24} />
                },
                {
                    title: "購物地圖 Shopping",
                    desc: "曼谷購物中心 & 夜市攻略",
                    url: "https://maps.app.goo.gl/op7Xk2frKrfWRcrL8",
                    color: "bg-[#C4E0E0]",
                    textColor: "text-[#0F1C20]",
                    icon: <ShoppingBag size={24} />
                },
                {
                    title: "咖啡廳地圖 Cafe Hopping",
                    desc: "網美咖啡廳 & 特色下午茶",
                    url: "https://maps.app.goo.gl/NHbWvGn2wFna6bTe6",
                    color: "bg-[#0F1C20]",
                    textColor: "text-white",
                    icon: <Coffee size={24} />
                }
            ];

            return (
                <div className="animate-fade-in px-6 pb-24 h-full flex flex-col">
                    <div className="flex justify-between items-center mb-6">
                        <h2 className="text-3xl font-bold text-[#0F1C20]">Trip Maps</h2>
                    </div>

                    <div className="space-y-4">
                        {maps.map((map, idx) => (
                            <a 
                                key={idx}
                                href={map.url}
                                target="_blank"
                                rel="noopener noreferrer"
                                className={`block ${map.color} rounded-[30px] p-6 shadow-lg transform transition-transform hover:scale-[1.02] relative overflow-hidden group min-h-[160px] flex flex-col justify-between`}
                            >
                                <div className="absolute top-0 right-0 w-32 h-32 bg-white opacity-10 rounded-full translate-x-10 -translate-y-10 blur-2xl"></div>
                                
                                <div className="flex justify-between items-start relative z-10">
                                    <div className={`p-3 rounded-full bg-white/20 ${map.textColor} backdrop-blur-sm`}>
                                        {map.icon}
                                    </div>
                                    <ExternalLink size={20} className={`${map.textColor} opacity-60`} />
                                </div>
                                
                                <div className="mt-4 relative z-10">
                                    <h3 className={`text-2xl font-bold ${map.textColor} mb-1`}>{map.title}</h3>
                                    <p className={`text-sm opacity-80 ${map.textColor}`}>{map.desc}</p>
                                </div>
                            </a>
                        ))}
                    </div>
                </div>
            );
        };

        // --- Main App Component ---

        const App = () => {
            const [activeTab, setActiveTab] = useState('home');
            const [selectedHotelForRooms, setSelectedHotelForRooms] = useState('huahin'); 

            // Background style to match the mint aesthetic
            const bgStyle = {
                backgroundColor: '#C4E0E0', 
                minHeight: '100vh',
                fontFamily: '"Inter", sans-serif',
            };

            return (
                <div style={bgStyle} className="relative text-[#0F1C20]">
                    {/* Main Content Area */}
                    <div className="max-w-md mx-auto bg-[#C4E0E0] min-h-screen relative shadow-2xl overflow-hidden">
                        {/* Decorative background blurs */}
                        <div className="absolute top-[-100px] left-[-100px] w-[300px] h-[300px] bg-white opacity-40 blur-[80px] rounded-full pointer-events-none"></div>
                        <div className="absolute bottom-[100px] right-[-50px] w-[200px] h-[200px] bg-[#FF9F68] opacity-20 blur-[60px] rounded-full pointer-events-none"></div>

                        <Header 
                            title={
                                activeTab === 'home' ? '' : 
                                activeTab === 'schedule' ? 'Trip Itinerary' :
                                activeTab === 'hotels' ? 'Hotels' : 
                                activeTab === 'room_list' ? 'Room Allocation' : 
                                activeTab === 'map' ? 'Trip Map' :
                                activeTab === 'notes' ? 'Travel Info' :
                                'Boarding Pass'
                            }
                            showBack={activeTab !== 'home'}
                            onBack={() => {
                                if (activeTab === 'room_list') {
                                    setActiveTab('hotels');
                                } else {
                                    setActiveTab('home');
                                }
                            }}
                        />

                        <main className="relative z-10 h-[calc(100vh-140px)] overflow-y-auto no-scrollbar">
                            {activeTab === 'home' && <HomeView setActiveTab={setActiveTab} />}
                            {activeTab === 'schedule' && <ScheduleView />}
                            {activeTab === 'hotels' && <HotelsView onViewRooms={(hotel) => {
                                setSelectedHotelForRooms(hotel);
                                setActiveTab('room_list');
                            }} />} 
                            {activeTab === 'room_list' && <RoomAllocationView hotel={selectedHotelForRooms} />}
                            {activeTab === 'tickets' && <TicketView />}
                            {activeTab === 'map' && <MapView />}
                            {activeTab === 'notes' && <NotesView />}
                        </main>

                        <PillNav activeTab={activeTab === 'room_list' ? 'hotels' : activeTab} setActiveTab={setActiveTab} />
                    </div>
                </div>
            );
        };

        const root = createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
